# Survey

## Create a Survey
```html
http://us.api.capillarytech.com/v2/survey/v2/survey
```

```json
{
		"title": "Product feedback survey"
		"surveyType": "online",
		"source": "Cloudcherry/Capillary",
		"brandLogo": "http://biz-colostate.files/starbucks-coffee.gif",
		"brandWebsite": "www.starbuck.com",
		"externalRefId":"123"
}

```

Allows creating a new survey 

### Resource Information
Information | Value
----------- | -----
URI | /survey
Authentication | Yes
HTTP Method | POST
Batch Support | No

### Sample Request
`http://<cluster url>/v2/survey`

### Request Attributes

Attribute | Description
--------- | -----------
title* | Specify the title of the survey form
surveyType | product survey, store survey, cloud cherry
source* | Source where the survey is hosted
brandLogo | Provide the path of the brand logo
brandWebsite | Provide the official web site link of the org
externalRefId* | Unique reference id of the survey that comes from the vendor



## Add Questions to a Survey
```html
http://us.api.capillarytech.com/v2/survey/questions?112
```

```json
[
  {
 "tag": "nps",
 "fieldType": "nps",
 "question": "How do you feel about the store?",
 "qxnExternalId":"112",
 "fieldOptions": "{\r\n\"opt1\": \"product not available\",\r\n\"opt2\": \"price too high \",\r\n\"opt3 \": \"I just don\u2019t like your store\"\r\n}",
 "parentId": 0,
 "params": ""
  }
]

```

Allows adding questions to the existing survey.

### Resource Information
Information | Value
----------- | -----
URI | /survey/questions?{surveyId/extRefId}
Authentication | Yes
HTTP Method | POST
Batch Support | Yes

### Sample Request
`http://<cluster url>/v2/survey/questions?{surveyId/extRefId}`

### Request Attributes

Attribute | Description
--------- | -----------
tag | 
fieldType* | Specify the type of the field - TextBlock, TextAreaBlock, Multiple Choice, Checkboxes, Scale, Star Rating, multiquestion, Add Call us back question, and nps
question* | Specify the survey question
qxnExternalId* | Pass the external id of the question provided by the vendor  
fieldOptions | Specify the options you want to provide for each question. Not applicable for TextBlock, TextAreaBlock
parentId | Survey questions can have sub questions. Example: The value will be 0 by default. If it is a sub-question, parent id will a positive value
params | 



## Add Survey Responses
```html
http://us.api.capillarytech.com/v2/survey/responses?112
```

```json
[{
		"surveyQuestionId": "233",
		"userId": 134223,
  		"formId":123,
 		"tokenId":1,
  		"fieldValue":"Sample answer",
		"entityType": "checkBox",
		"entityId": 222,
		"responseChannel": "online"
}]

```

Allows adding customer responses to a survey

### Resource Information
Information | Value
----------- | -----
URI | /survey/responses?{surveyId/extRefId}
Authentication | Yes
HTTP Method | POST
Batch Support | Yes

### Sample Request
`http://<cluster url>/v2/survey/responses?{surveyId/extRefId}`

### Request Attributes

Attribute | Description
--------- | -----------
surveyQuestionId* | Pass the id of the survey question
userId* | Provide the user id of the customer responded to the survey
formId* | Provide the unique form id of the survey campaign 
tokenId* | Provide the unique id assigned to a customer to submit a survey
fieldValue* | Specify the value/answer chosen for the question
entityType | Specify the entity type of the survey - checkBox/TextBox/SelectBox/TextArea/radiobutton
entityId | Pass the id of the respective entity type
responseChannel | Specify the response channel - online/ offline
 


## Retrieve Details of a Survey

```html
http://us.intouch.capillarytech.com/v2/survey?extRefId=123
```

```json
{
"id": 101,
"brandLogo": "http://biz-colostate.files/starbucks-coffee.gif",
"brandWebsite": "www.samplebramd.com",
"source": "Cloudcherry/Capillary",
"surveyType": "Online",
"title": "Feedback Survey",
"externalRefId": "123",
"lastUpdatedOn": "2017-12-04",
"warnings":[]
}
```
Retrieves the details of a specific survey.

### Resource Information
Information | Value
----------- | -----
URI | /survey?{surveyId/extRefId}
Authentication | Yes
HTTP Method | GET
Batch Support | No

### Sample Request
http://<cluster url>/v2/survey?{surveyId/extRefId}

### Request Attributes

Parameter | Description
--------- | -----------
surveyId | The unique id of the survey campaign generated by Capillary
extRefId | The unique id for the survey generated by the vendor




## Retrieve All Questions of a Survey
```html
http://us.intouch.capillarytech.com/v2/survey/questions/214
```

```json
{
    "data": [
        {
            "id": 208,
            "qxnExternalId": "Question01",
            "question": "Question01",
            "fieldOptions": "{\r\n\"opt1\": \"product not available\",\r\n\"opt2\": \"price too high \",\r\n\"opt3 \": \"I just don’t like your store\"\r\n}",
            "fieldType": "text",
            "tag": "Nps",
            "isActive": true,
            "lastUpdatedOn": "2017-12-05",
            "parentId": 0,
            "params": "string"
        },
        {
            "id": 209,
            "qxnExternalId": "Question02",
            "question": "Question02",
            "fieldOptions": "{\r\n\"opt1\": \"product not available\",\r\n\"opt2\": \"price too high \",\r\n\"opt3 \": \"I just don’t like your store\"\r\n}",
            "fieldType": "text",
            "tag": "Nps",
            "isActive": true,
            "lastUpdatedOn": "2017-12-05",
            "parentId": 0,
            "params": "string"
        },
        {
            "id": 210,
            "qxnExternalId": "Question01",
            "question": "Question01",
            "fieldOptions": "{\r\n\"opt1\": \"product not available\",\r\n\"opt2\": \"price too high \",\r\n\"opt3 \": \"I just don’t like your store\"\r\n}",
            "fieldType": "text",
            "tag": "Nps",
            "isActive": true,
            "lastUpdatedOn": "2017-12-05",
            "parentId": 0,
            "params": "string"
        },
        {
            "id": 211,
            "qxnExternalId": "Question01",
            "question": "Question01",
            "fieldOptions": "{\r\n\"opt1\": \"product not available\",\r\n\"opt2\": \"price too high \",\r\n\"opt3 \": \"I just don’t like your store\"\r\n}",
            "fieldType": "text",
            "tag": "Nps",
            "isActive": true,
            "lastUpdatedOn": "2017-12-06",
            "parentId": 0,
            "params": "string"
        },
        {
            "id": 216,
            "qxnExternalId": "Question01",
            "question": "Question01",
            "fieldOptions": "{\r\n\"opt1\": \"product not available\",\r\n\"opt2\": \"price too high \",\r\n\"opt3 \": \"I just don’t like your store\"\r\n}",
            "fieldType": "text",
            "tag": "Nps",
            "isActive": true,
            "lastUpdatedOn": "2017-12-06",
            "parentId": 0,
            "params": "bbbb"
        }
    ],
    "warnings": [
    ],
    "errors": [
    ]
}
```

Retrieves all questions of a specific survey.

### Resource Information
Information | Value
----------- | -----
URI | /survey/questions/{survey question id}
Authentication | Yes
HTTP Method | GET
Batch Support | No

### Sample Request
http://<cluster url>/v2/survey/questions/{survey question id}


### Request Parameters

Parameter | Description
--------- | -----------
Survey question id | Pass the primary key of the question id


## Retrieve Details of a Specific Question
```html
http://api.nightly.capillary.in/v2/survey/questions/214
```

```json
{
    "id": 214,
    "qxnExternalId": "Question01",
    "question": "Question01",
    "fieldOptions": "{\r\n\"opt1\": \"product not available\",\r\n\"opt2\": \"price too high \",\r\n\"opt3 \": \"I just don’t like your store\"\r\n}",
    "fieldType": "Multiple Choice",
    "tag": "nps",
    "isActive": true,
    "lastUpdatedOn": "2017-12-06",
    "parentId": 0,
    "params": "",
    "warnings": [
    ]
}
```

Retrieves details of a specific question.

### Resource Information
Information | Value
----------- | -----
URI | /survey/questions/{question external id}
Authentication | Yes
HTTP Method | GET
Batch Support | No


### Request URL
`http://<Cluster URL>/v2/survey/questions/<survey question id>`

### Request Parameter
Parameter | Description
--------- | ----------
Survey question id* | Pass the question id for which you want to see the details





## Retrieve the ID of a Specific Question
```html
http://us.intouch.capillarytech.com/v2/survey/questions/lookup/112

```json
{
    "entity": 255,
    "warnings": [
    ]
}
```


Retrieves the id of a specific survey question.


### Resource Information
Information | Value
----------- | -----
URI | /survey/questions/lookup/{question external id}
Authentication | Yes
HTTP Method | GET
Batch Support | No

### Request URL
`http://<cluster url>/v2/survey/questions/lookup/<question external id>`


### Request Parameters

Parameter | Description
--------- | -----------
Question External ID |  Pass the unique external id of the question



## Retrieve Details of a Specific Response
```html
http://us.intouch.capillarytech.com/v2/survey/responses/118
```

```json
{
    "id": 118,
    "surveyQuestionId": 256,
    "entityId": 0,
    "fieldValue": "Sample answer",
    "formId": 1234,
    "userId": 13422223,
    "tokenId": 23,
    "lastUpdatedOn": "2017-12-07",
    "warnings": [
    ]
}
```

Retrieves the details of a specific survey response.


### Resource Information
Information | Value
----------- | -----
URI | /responses/{response id}?{surveyId/extRefId}
Authentication | Yes
HTTP Method | GET
Batch Support | No

### Request URL
`http://<Cluster URL>/v2/survey/responses/<response id>`


### Request Parameters
Parameters | Description
---------- | -----------
surveyId/extRefId* | Provide the survey id or external reference id of the survey for which you want to fetch a specific response
response id* | Provide the response id that you want to fetch


### Response Codes

Code | Description
---- | -----------
9001 | Invalid survey id
9002 | Invalid survey question id
9003 | No surveys found
9004 | No survey questions found
9005 | No survey responses found
9006 | Invalid survey external reference id passed
9007 | Unable to add survey questions
9008 | Survey external reference id already exists
9010 | Question external id {x} already exists
9011 | Invalid survey question external id {0} passed for lookup
9012 | Duplicate survey question external id {0} in request 
